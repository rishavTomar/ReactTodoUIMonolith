name: ReactPipeLine

trigger: none

pool: 
  vmImage: ubuntu-latest

stages:
- stage: Build
  jobs:
  - job: BuildApp
    displayName: Building React App
    steps:
    - task: NodeTool@0
      inputs:
        versionSource: 'spec'
        versionSpec: '16.x'
    - task: Npm@1
      inputs:
        command: 'install'
    - task: Npm@1
      inputs:
        command: 'custom'
        customCommand: 'run build'
    - task: PublishBuildArtifacts@1
      inputs:
        PathtoPublish: '$(Build.SourcesDirectory)/build'
        ArtifactName: 'drop'
        publishLocation: 'Container'
        
- stage: Deploy
  jobs:
    - job: DeployApp
      displayName: React App Deployment
      steps:
      - download: current
        artifact: drop
      - task: AzureWebApp@1
        inputs:
          azureSubscription: 'LearningsOwner'
          appType: 'webAppLinux'
          appName: 'ReactWebAppRishav'
          package: '$(Pipeline.Workspace)/drop/**/*.zip'
